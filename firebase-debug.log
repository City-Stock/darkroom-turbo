[debug] [2024-08-09T16:10:00.742Z] ----------------------------------------------------------------------
[debug] [2024-08-09T16:10:00.745Z] Command:       /Users/artemaleksandruk/.nvm/versions/node/v20.10.0/bin/node /Users/artemaleksandruk/Development/ess/darkroom/darkroom-turbo/node_modules/firebase-tools/lib/bin/firebase.js deploy --only functions
[debug] [2024-08-09T16:10:00.745Z] CLI Version:   13.15.0
[debug] [2024-08-09T16:10:00.745Z] Platform:      darwin
[debug] [2024-08-09T16:10:00.745Z] Node Version:  v20.10.0
[debug] [2024-08-09T16:10:00.745Z] Time:          Fri Aug 09 2024 12:10:00 GMT-0400 (Eastern Daylight Time)
[debug] [2024-08-09T16:10:00.745Z] ----------------------------------------------------------------------
[debug] 
[debug] [2024-08-09T16:10:00.746Z] >>> [apiv2][query] GET https://firebase-public.firebaseio.com/cli.json [none]
[debug] [2024-08-09T16:10:00.804Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2024-08-09T16:10:00.804Z] > authorizing via signed-in user (devops@citystock.co)
[debug] [2024-08-09T16:10:00.804Z] [iam] checking project citystock-darkroom-dev for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2024-08-09T16:10:00.804Z] > refreshing access token with scopes: []
[debug] [2024-08-09T16:10:00.805Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2024-08-09T16:10:00.805Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2024-08-09T16:10:00.942Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2024-08-09T16:10:00.942Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2024-08-09T16:10:00.948Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/citystock-darkroom-dev:testIamPermissions [none]
[debug] [2024-08-09T16:10:00.948Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/citystock-darkroom-dev:testIamPermissions x-goog-quota-user=projects/citystock-darkroom-dev
[debug] [2024-08-09T16:10:00.948Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/citystock-darkroom-dev:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2024-08-09T16:10:00.999Z] <<< [apiv2][status] GET https://firebase-public.firebaseio.com/cli.json 200
[debug] [2024-08-09T16:10:00.999Z] <<< [apiv2][body] GET https://firebase-public.firebaseio.com/cli.json {"cloudBuildErrorAfter":1594252800000,"cloudBuildWarnAfter":1590019200000,"defaultNode10After":1594252800000,"minVersion":"3.0.5","node8DeploysDisabledAfter":1613390400000,"node8RuntimeDisabledAfter":1615809600000,"node8WarnAfter":1600128000000}
[debug] [2024-08-09T16:10:01.141Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/citystock-darkroom-dev:testIamPermissions 200
[debug] [2024-08-09T16:10:01.141Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/citystock-darkroom-dev:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2024-08-09T16:10:01.142Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/citystock-darkroom-dev/serviceAccounts/citystock-darkroom-dev@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2024-08-09T16:10:01.142Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/citystock-darkroom-dev/serviceAccounts/citystock-darkroom-dev@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2024-08-09T16:10:01.335Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/citystock-darkroom-dev/serviceAccounts/citystock-darkroom-dev@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2024-08-09T16:10:01.335Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/citystock-darkroom-dev/serviceAccounts/citystock-darkroom-dev@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'citystock-darkroom-dev'...
[info] 
[info] i  deploying functions 
[info] Running command: npm run build --prefix firebase-functions/start-file-process
[info] ✔  functions: Finished running predeploy script. 
[info] Running command: npm run build --prefix firebase-functions/hello-world
[info] ✔  functions: Finished running predeploy script. 
[debug] [2024-08-09T16:10:05.095Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/citystock-darkroom-dev [none]
[debug] [2024-08-09T16:10:05.432Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/citystock-darkroom-dev 200
[debug] [2024-08-09T16:10:05.432Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/citystock-darkroom-dev {"projectId":"citystock-darkroom-dev","projectNumber":"53682184378","displayName":"citystock-darkroom-dev","name":"projects/citystock-darkroom-dev","resources":{"hostingSite":"citystock-darkroom-dev","storageBucket":"citystock-darkroom-dev.appspot.com","locationId":"us-central"},"state":"ACTIVE","etag":"1_8e907eef-58e5-4298-a8a3-200cf939db34"}
[info] i  functions: preparing codebase start-file-process for deployment 
[info] i  functions: preparing codebase hello-world for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2024-08-09T16:10:05.434Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudfunctions.googleapis.com [none]
[debug] [2024-08-09T16:10:05.435Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/citystock-darkroom-dev
[debug] [2024-08-09T16:10:05.436Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/runtimeconfig.googleapis.com [none]
[debug] [2024-08-09T16:10:05.436Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/citystock-darkroom-dev
[debug] [2024-08-09T16:10:05.437Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudbuild.googleapis.com [none]
[debug] [2024-08-09T16:10:05.438Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudbuild.googleapis.com x-goog-quota-user=projects/citystock-darkroom-dev
[debug] [2024-08-09T16:10:05.438Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/artifactregistry.googleapis.com [none]
[debug] [2024-08-09T16:10:05.438Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/artifactregistry.googleapis.com x-goog-quota-user=projects/citystock-darkroom-dev
[debug] [2024-08-09T16:10:05.898Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/runtimeconfig.googleapis.com 200
[debug] [2024-08-09T16:10:05.899Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/runtimeconfig.googleapis.com [omitted]
[debug] [2024-08-09T16:10:05.899Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudbuild.googleapis.com 200
[debug] [2024-08-09T16:10:05.899Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2024-08-09T16:10:05.935Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/artifactregistry.googleapis.com 200
[debug] [2024-08-09T16:10:05.935Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2024-08-09T16:10:05.936Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudfunctions.googleapis.com 200
[debug] [2024-08-09T16:10:05.936Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/citystock-darkroom-dev/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2024-08-09T16:10:05.936Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/citystock-darkroom-dev/adminSdkConfig [none]
[debug] [2024-08-09T16:10:06.300Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/citystock-darkroom-dev/adminSdkConfig 200
[debug] [2024-08-09T16:10:06.302Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/citystock-darkroom-dev/adminSdkConfig {"projectId":"citystock-darkroom-dev","storageBucket":"citystock-darkroom-dev.appspot.com","locationId":"us-central"}
[debug] [2024-08-09T16:10:06.303Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/citystock-darkroom-dev/configs [none]
[debug] [2024-08-09T16:10:06.481Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/citystock-darkroom-dev/configs 200
[debug] [2024-08-09T16:10:06.482Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/citystock-darkroom-dev/configs {}
[debug] [2024-08-09T16:10:06.485Z] Validating nodejs source
[debug] [2024-08-09T16:10:06.814Z] > [functions] package.json contents: {
  "name": "start-file-process",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "20"
  },
  "main": "lib/index.js",
  "dependencies": {
    "firebase-admin": "^12.1.0",
    "firebase-functions": "^5.0.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0",
    "@types/node": "^18.11.5"
  },
  "private": true
}
[debug] [2024-08-09T16:10:06.814Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase start-file-process to determine what to deploy 
[debug] [2024-08-09T16:10:06.815Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-08-09T16:10:06.819Z] Found firebase-functions binary at '/Users/artemaleksandruk/Development/ess/darkroom/darkroom-turbo/firebase-functions/start-file-process/node_modules/.bin/firebase-functions'
[info] Serving at port 8220

[debug] [2024-08-09T16:10:07.085Z] Got response from /__/functions.yaml {"endpoints":{"startFileProcess":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"eventTrigger":{"eventType":"google.cloud.firestore.document.v1.updated","eventFilters":{"database":"(default)","namespace":"(default)"},"eventFilterPathPatterns":{"document":"assets/{assetId}"},"retry":false},"entryPoint":"startFileProcess"}},"specVersion":"v1alpha1","requiredAPIs":[]}
